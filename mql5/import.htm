<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="keywords" content="online documentation, web online help, web help, chm2web" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="generator" content="chm2web Pro 2.85 (unicode)" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Content-Style-Type" content="text/css">

<title>Importing Functions (#import)</title>
<meta name="keywords" content="#import">
<link rel="stylesheet" href="files/helpindex.css" type="text/css">
<link rel="stylesheet" href="default.css" type="text/css">

<script type="text/JavaScript" src="files/supply.js"></script>
<script type="text/JavaScript">
chmtop.c2wtopf.pageid = "import.htm";
</script>

</head>
<body style=
"background-color:#FFFFFF; font-family:'Trebuchet MS',Tahoma,Arial,Helvetica,sans-serif; margin:0px;"><script type="text/JavaScript"> 
if (window.name != "content") 
  document.write(" <table width=\"100%\" bgcolor=\"#e1e1e1\"cellspacing=\"2\" cellpadding=\"0\" style=\"border-collapse: collapse; font-family: sans-serif; font-size: 14px; color: #000000; text-decoration: none;  \"> <tr> <td align=\"center\" style=\"border-bottom: 2px solid gray\" > <br>&nbsp;Click <a href=\"index.html?page=import.htm\">here</a> to show toolbars of the Web Online Help System: <a href=\"index.html?page=import.htm\">show toolbars</a><br>&nbsp;</td></tr></table><br> "); 
</script>
<!-- !chm2web! -->


<table width="100%" border="0" cellpadding="0" cellspacing="0"
style=
"margin:0; background: #7F90A5 url('gradient_header.png') repeat-x left top; border-bottom: 3px solid #DBE0E5;">
<tr>
<td valign="middle">
<table style="margin: 10px 0" width="100%" border="0" cellspacing=
"0" cellpadding="0">
<tr valign="middle">
<td class="nav"><a class="h_m" href="index.htm">MQL5 Reference</a>
/ <a class="h_m" href="basis.htm">Language Basics</a> / <a class=
"h_m" href="preprosessor.htm">Preprocessor</a> / Importing
Functions &nbsp;(#import)</td>
<td align="right" style="white-space: nowrap; padding: 0 10px;">
<a href="include.htm"><img style="vertical-align:middle;" src=
"previous.png" alt="Back" width="27" height="27" border=
"0"></a><a href="conditional_compilation.htm"><img style=
"vertical-align:middle;margin-left: 7px;" src="next.png" alt=
"Forward" width="27" height="27" border="0"></a>
</td>
</tr>
</table>
</td>
</tr>
</table>

<div id="help">
<p class="p_H1"><span class="f_H1">Importing Function
(#import)</span>
</p>

<p class="p_Text"><span class="f_Text">Functions are imported from
compiled MQL5 modules (*. ex5 files) and from operating system
modules (files *. dll). The module name is specified in the</span>
<span class="f_Text" style="font-style: italic;">#import</span>
<span class="f_Text">directive. For compiler to be able to
correctly form the imported function call and organize proper
<a href="parameterpass.htm" class="topiclink">transmission
parameters</a>, the full description of <a href="function.htm"
class="topiclink">functions</a> is needed. Function descriptions
immediately follow the</span> <span class="f_Text" style=
"font-style: italic;">#import "module name"</span> <span class=
"f_Text">directive. New command</span> <span class="f_Text" style=
"font-style: italic;">#import</span> <span class="f_Text">(can be
without parameters) completes the block of imported function
descriptions.</span></p>

<div style=
"text-align: left; text-indent: 0px; border-color: #b3b3b3; border-style: solid; border-width: 1px; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
<table cellspacing="0" cellpadding="3" border="0" style=
"text-align: justify;border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:3px;">
<p class="p_CodeExample"><span class="f_CodeExample" style=
"color: #0000ff;">#import</span><span class=
"f_CodeExample">&nbsp;</span><span class="f_CodeExample" style=
"color: #008080;">"file_name"</span><br>
<span class=
"f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;func1&nbsp;define;</span><br>
<span class=
"f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;func2&nbsp;define;</span><br>
<span class="f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;...</span><br>
<span class=
"f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;funcN&nbsp;define;</span><br>
<span class="f_CodeExample" style="color: #0000ff;">#import</span>
</p>
</td>
</tr>
</table>
</div>

<p class="p_Text"><span class="f_Text">Imported functions can have
any names. Functions having the same names but from different
modules can be imported at the same time. Imported functions can
have names that coincide with the names of built-in functions.
Operation of <a href="other.htm#context_allow" class=
"topiclink">scope resolution</a> defines which of the functions
should be called.</span>
</p>

<p class="p_Text"><span class="f_Text">The order of searching for a
file specified after the</span> <span class="f_Text" style=
"color: #0000ff;">#import</span> <span class="f_Text">keyword is
described in <a href="imports.htm" class="topiclink">Call of
Imported Functions</a>.</span></p>

<p class="p_Text"><span class="f_Text">Since the imported functions
are outside the compiled module, the compiler can not verify the
validity of passed parameters. Therefore, to avoid run-time errors,
one must accurately describe the composition and order of
parameters passed to imported functions. Parameters passed to
imported functions (both from EX5, and from the DLL-module) can
have default values.</span>
</p>

<p class="p_Text"><span class="f_Text">The following can't be used
for parameters in imported functions:</span>
</p>

<ul class="help_list" style=
"text-align: justify; text-indent: 0px; padding: 0px 0px 0px 17px; margin: 3px 17px 3px 17px;">
<li><span class="f_li"><a href="object_pointers.htm" class=
"topiclink">pointers</a> (*);</span>
</li>

<li><span class="f_li">links to objects that contain <a href=
"dynamic_array.htm" class="topiclink">dynamic arrays</a> and/or
pointers.</span>
</li>
</ul>

<p class="p_li"><span class="f_li">Classes, string arrays or
complex objects that contain strings and/or dynamic arrays of any
types cannot be passed as a parameter to functions imported from
DLL.</span>
</p>

<p class="p_Text"><span class="f_Text" style=
"font-weight: bold;">Examples:</span>
</p>

<div style=
"text-align: left; text-indent: 0px; border-color: #b3b3b3; border-style: solid; border-width: 1px; background: #fbf9f5; padding: 0px 0px 0px 0px; margin: 2px 17px 2px 17px;">
<table cellspacing="0" cellpadding="3" border="0" style=
"text-align: justify;border:none; border-spacing:0px;">
<tr style="text-align:left;vertical-align:top;">
<td style="vertical-align:top; padding:3px;">
<p class="p_CodeExample"><span class="f_CodeExample" style=
"color: #0000ff;">#import</span><span class=
"f_CodeExample">&nbsp;</span><span class="f_CodeExample" style=
"color: #008080;">"user32.dll"</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;MessageBoxW(</span><span class="f_CodeExample"
style="color: #0000ff;">uint</span><span class=
"f_CodeExample">&nbsp;hWnd,</span><span class="f_CodeExample"
style="color: #0000ff;">string</span><span class=
"f_CodeExample">&nbsp;lpText,</span><span class="f_CodeExample"
style="color: #0000ff;">string</span><span class=
"f_CodeExample">&nbsp;lpCaption,</span><span class="f_CodeExample"
style="color: #0000ff;">uint</span><span class=
"f_CodeExample">&nbsp;uType);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">#import</span><span class=
"f_CodeExample">&nbsp;</span><span class="f_CodeExample" style=
"color: #008080;">"stdlib.ex5"</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">string</span><span class=
"f_CodeExample">&nbsp;ErrorDescription(</span><span class=
"f_CodeExample" style="color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;error_code);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;RGB(</span><span class=
"f_CodeExample" style="color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;red_value,</span><span class="f_CodeExample"
style="color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;green_value,</span><span class=
"f_CodeExample" style="color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;blue_value);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">bool</span><span class=
"f_CodeExample">&nbsp;&nbsp;&nbsp;CompareDoubles(</span><span class="f_CodeExample"
style="color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;number1,</span><span class="f_CodeExample"
style="color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;number2);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">string</span><span class=
"f_CodeExample">&nbsp;DoubleToStrMorePrecision(</span><span class=
"f_CodeExample" style="color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;number,</span><span class="f_CodeExample"
style="color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;precision);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">string</span><span class=
"f_CodeExample">&nbsp;IntegerToHexString(</span><span class=
"f_CodeExample" style="color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;integer_number);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">#import</span><span class=
"f_CodeExample">&nbsp;</span><span class="f_CodeExample" style=
"color: #008080;">"ExpertSample.dll"</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">int</span><span class=
"f_CodeExample">&nbsp;&nbsp;&nbsp;&nbsp;GetIntValue(</span><span class="f_CodeExample"
style="color: #0000ff;">int</span><span class=
"f_CodeExample">);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;GetDoubleValue(</span><span class=
"f_CodeExample" style="color: #0000ff;">double</span><span class=
"f_CodeExample">);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">string</span><span class=
"f_CodeExample">&nbsp;GetStringValue(</span><span class=
"f_CodeExample" style="color: #0000ff;">string</span><span class=
"f_CodeExample">);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;GetArrayItemValue(</span><span class=
"f_CodeExample" style="color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;&amp;arr[],</span><span class="f_CodeExample"
style="color: #0000ff;">int</span><span class=
"f_CodeExample">,</span><span class="f_CodeExample" style=
"color: #0000ff;">int</span><span class=
"f_CodeExample">);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">bool</span><span class=
"f_CodeExample">&nbsp;&nbsp;&nbsp;SetArrayItemValue(</span><span class="f_CodeExample"
style="color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;&amp;arr[],</span><span class="f_CodeExample"
style="color: #0000ff;">int</span><span class=
"f_CodeExample">,</span><span class="f_CodeExample" style=
"color: #0000ff;">int</span><span class=
"f_CodeExample">,</span><span class="f_CodeExample" style=
"color: #0000ff;">double</span><span class=
"f_CodeExample">);</span><br>
<span class="f_CodeExample" style=
"color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;GetRatesItemValue(</span><span class=
"f_CodeExample" style="color: #0000ff;">double</span><span class=
"f_CodeExample">&nbsp;&amp;rates[][6],</span><span class=
"f_CodeExample" style="color: #0000ff;">int</span><span class=
"f_CodeExample">,</span><span class="f_CodeExample" style=
"color: #0000ff;">int</span><span class=
"f_CodeExample">,</span><span class="f_CodeExample" style=
"color: #0000ff;">int</span><span class=
"f_CodeExample">);</span><br>
<span class="f_CodeExample" style="color: #0000ff;">#import</span>
</p>
</td>
</tr>
</table>
</div>

<p class="p_Text"><span class="f_Text">To import functions during
execution of a mql5 program, early binding is used. This means that
the library is loaded during the loading of a program using its ex5
program.</span>
</p>

<p class="p_Text"><span class="f_Text">It's not recommended to use
a fully qualified name of the loadable module of type</span>
<span class="f_Text" style=
"font-style: italic;">Drive:\Directory\FileName.Ext</span><span class="f_Text">.
MQL5 libraries are loaded from the</span> <span class="f_Text"
style="font-style: italic;">terminal_dir\MQL5\Libraries</span>
<span class="f_Text">folder.</span></p>

<p class="p_BoldTitles"><span class="f_BoldTitles">See also</span>
</p>

<p class="p_SeeAlso"><span class="f_SeeAlso"><a href="include.htm"
class="topiclink">Including Files</a></span>
</p>
<br>
</div>

<script type="text/JavaScript">
var fe = FindFrame("toc", top);
if ((fe != null) && (chmtop.c2wtopf.jstree != null)) {
  if (chmtop.c2wtopf.FITEMS[chmtop.c2wtopf.pagenum] != chmtop.c2wtopf.pageid)
    chmtop.c2wtopf.jstree.OpenTreeNode("" + chmtop.c2wtopf.pageid);
}
</script>

<!-- CHM2WEB -->
<!-- DO NOT DELETE OR MODIFY THIS CODE WITHOUT 
     WRITTEN PERMISSION OF A!K RESEARCH LABS -->
<table width="100%" cellspacing="0" cellpadding="0" 
style="margin-top: 0pt; border-collapse: collapse;"> 
<tr> <td align="right" style="background-color:white; border-top: 1px solid gray;"> 
<a href="http://chm2web.aklabs.com" target="_blank" style="font-family: sans-serif;  font-size: 11px; text-decoration: none;"><font color="gray">Converted from CHM to HTML with <b>chm2web Pro 2.85 (unicode)</b></font></a>
</td></tr></table> 
<!-- /CHM2WEB -->

</body>
</html>
